<script setup lang="ts">
import { ref, computed } from 'vue'
import { ScrollArea } from '@/components/ui/scroll-area'

const emit = defineEmits<{ select: [emoji: string] }>()

const categories = [
  {
    name: 'Smileys',
    emojis: ['ðŸ˜€','ðŸ˜ƒ','ðŸ˜„','ðŸ˜','ðŸ˜†','ðŸ˜…','ðŸ¤£','ðŸ˜‚','ðŸ™‚','ðŸ˜Š','ðŸ˜‡','ðŸ¥°','ðŸ˜','ðŸ¤©','ðŸ˜˜','ðŸ˜—','ðŸ˜‹','ðŸ˜›','ðŸ˜œ','ðŸ¤ª','ðŸ˜','ðŸ¤‘','ðŸ¤—','ðŸ¤­','ðŸ¤«','ðŸ¤”','ðŸ˜','ðŸ˜‘','ðŸ˜¶','ðŸ˜','ðŸ˜’','ðŸ™„','ðŸ˜¬','ðŸ˜®â€ðŸ’¨','ðŸ¤¥','ðŸ˜Œ','ðŸ˜”','ðŸ˜ª','ðŸ¤¤','ðŸ˜´','ðŸ˜·','ðŸ¤’','ðŸ¤•','ðŸ¤¢','ðŸ¤®','ðŸ¥µ','ðŸ¥¶','ðŸ¥´','ðŸ˜µ','ðŸ¤¯','ðŸ¤ ','ðŸ¥³','ðŸ¥¸','ðŸ˜Ž','ðŸ¤“','ðŸ§','ðŸ˜•','ðŸ˜Ÿ','ðŸ™','ðŸ˜®','ðŸ˜¯','ðŸ˜²','ðŸ˜³','ðŸ¥º','ðŸ˜¦','ðŸ˜§','ðŸ˜¨','ðŸ˜°','ðŸ˜¥','ðŸ˜¢','ðŸ˜­','ðŸ˜±','ðŸ˜–','ðŸ˜£','ðŸ˜ž','ðŸ˜“','ðŸ˜©','ðŸ˜«','ðŸ¥±','ðŸ˜¤','ðŸ˜¡','ðŸ˜ ','ðŸ¤¬','ðŸ˜ˆ','ðŸ‘¿','ðŸ’€','â˜ ï¸','ðŸ’©','ðŸ¤¡','ðŸ‘¹','ðŸ‘º','ðŸ‘»','ðŸ‘½','ðŸ‘¾','ðŸ¤–'],
  },
  {
    name: 'Gestures',
    emojis: ['ðŸ‘‹','ðŸ¤š','ðŸ–ï¸','âœ‹','ðŸ––','ðŸ‘Œ','ðŸ¤Œ','ðŸ¤','âœŒï¸','ðŸ¤ž','ðŸ¤Ÿ','ðŸ¤˜','ðŸ¤™','ðŸ‘ˆ','ðŸ‘‰','ðŸ‘†','ðŸ–•','ðŸ‘‡','â˜ï¸','ðŸ‘','ðŸ‘Ž','âœŠ','ðŸ‘Š','ðŸ¤›','ðŸ¤œ','ðŸ‘','ðŸ™Œ','ðŸ‘','ðŸ¤²','ðŸ¤','ðŸ™','âœï¸','ðŸ’…','ðŸ¤³','ðŸ’ª','ðŸ¦¾','ðŸ¦¿'],
  },
  {
    name: 'Hearts',
    emojis: ['â¤ï¸','ðŸ§¡','ðŸ’›','ðŸ’š','ðŸ’™','ðŸ’œ','ðŸ–¤','ðŸ¤','ðŸ¤Ž','ðŸ’”','â£ï¸','ðŸ’•','ðŸ’ž','ðŸ’“','ðŸ’—','ðŸ’–','ðŸ’˜','ðŸ’','ðŸ’Ÿ'],
  },
  {
    name: 'Animals',
    emojis: ['ðŸ¶','ðŸ±','ðŸ­','ðŸ¹','ðŸ°','ðŸ¦Š','ðŸ»','ðŸ¼','ðŸ»â€â„ï¸','ðŸ¨','ðŸ¯','ðŸ¦','ðŸ®','ðŸ·','ðŸ¸','ðŸµ','ðŸ™ˆ','ðŸ™‰','ðŸ™Š','ðŸ’','ðŸ”','ðŸ§','ðŸ¦','ðŸ¤','ðŸ£','ðŸ¥','ðŸ¦†','ðŸ¦…','ðŸ¦‰','ðŸ¦‡','ðŸº','ðŸ—','ðŸ´','ðŸ¦„','ðŸ','ðŸª±','ðŸ›','ðŸ¦‹','ðŸŒ','ðŸž','ðŸœ','ðŸª°','ðŸª²','ðŸª³','ðŸ¦Ÿ','ðŸ¦—','ðŸ•·ï¸','ðŸ¢','ðŸ','ðŸ¦Ž','ðŸ¦–','ðŸ¦•','ðŸ™','ðŸ¦‘','ðŸ¦','ðŸ¦ž','ðŸ¦€','ðŸ¡','ðŸ ','ðŸŸ','ðŸ¬','ðŸ³','ðŸ‹','ðŸ¦ˆ','ðŸŠ'],
  },
  {
    name: 'Food',
    emojis: ['ðŸŽ','ðŸ','ðŸŠ','ðŸ‹','ðŸŒ','ðŸ‰','ðŸ‡','ðŸ“','ðŸ«','ðŸˆ','ðŸ’','ðŸ‘','ðŸ¥­','ðŸ','ðŸ¥¥','ðŸ¥','ðŸ…','ðŸ¥‘','ðŸ†','ðŸŒ¶ï¸','ðŸ«‘','ðŸ¥’','ðŸ¥¬','ðŸ¥¦','ðŸ§…','ðŸ§„','ðŸ¥”','ðŸ ','ðŸ¥','ðŸ¥–','ðŸž','ðŸ¥¨','ðŸ¥¯','ðŸ§€','ðŸ¥š','ðŸ³','ðŸ§ˆ','ðŸ¥ž','ðŸ§‡','ðŸ¥“','ðŸ¥©','ðŸ—','ðŸ–','ðŸŒ­','ðŸ”','ðŸŸ','ðŸ•','ðŸ«“','ðŸ¥ª','ðŸŒ®','ðŸŒ¯','ðŸ«”','ðŸ¥™','ðŸ§†','ðŸ¥—','ðŸ','ðŸœ','ðŸ²','ðŸ›','ðŸ£','ðŸ±','ðŸ¥Ÿ','ðŸ¦ª','ðŸ¤','ðŸ™','ðŸš','ðŸ˜','ðŸ¥','ðŸ¥ ','ðŸ¥®','ðŸ¢','ðŸ¡','ðŸ§','ðŸ¨','ðŸ¦','ðŸ¥§','ðŸ§','ðŸ°','ðŸŽ‚','ðŸ®','ðŸ­','ðŸ¬','ðŸ«','ðŸ¿','ðŸ©','ðŸª','ðŸŒ°','ðŸ¥œ','ðŸ¯'],
  },
  {
    name: 'Activities',
    emojis: ['âš½','ðŸ€','ðŸˆ','âš¾','ðŸ¥Ž','ðŸŽ¾','ðŸ','ðŸ‰','ðŸ¥','ðŸŽ±','ðŸª€','ðŸ“','ðŸ¸','ðŸ’','ðŸ¥…','â›³','ðŸªƒ','ðŸ¹','ðŸŽ£','ðŸ¤¿','ðŸ¥Š','ðŸ¥‹','ðŸŽ½','ðŸ›¹','ðŸ›¼','ðŸ›·','â›¸ï¸','ðŸ¥Œ','ðŸŽ¿','â›·ï¸','ðŸ‚','ðŸª‚','ðŸŽª','ðŸŽ­','ðŸŽ¨','ðŸŽ¬','ðŸŽ¤','ðŸŽ§','ðŸŽ¼','ðŸŽ¹','ðŸ¥','ðŸª˜','ðŸŽ·','ðŸŽº','ðŸª—','ðŸŽ¸','ðŸª•','ðŸŽ»','ðŸŽ²','â™Ÿï¸','ðŸŽ¯','ðŸŽ³','ðŸŽ®','ðŸ•¹ï¸','ðŸŽ°'],
  },
  {
    name: 'Objects',
    emojis: ['ðŸ’¡','ðŸ”¦','ðŸ•¯ï¸','ðŸ“±','ðŸ’»','âŒ¨ï¸','ðŸ–¥ï¸','ðŸ–¨ï¸','ðŸ–±ï¸','ðŸ’¾','ðŸ’¿','ðŸ“€','ðŸŽ¥','ðŸŽžï¸','ðŸ“·','ðŸ“¸','ðŸ“¹','ðŸ“ž','â˜Žï¸','ðŸ“Ÿ','ðŸ“ ','ðŸ“º','ðŸ“»','ðŸŽ™ï¸','ðŸŽšï¸','ðŸŽ›ï¸','â±ï¸','â²ï¸','â°','ðŸ•°ï¸','ðŸ””','ðŸ”•','ðŸ“£','ðŸ“¢','ðŸ’°','ðŸª™','ðŸ’´','ðŸ’µ','ðŸ’¶','ðŸ’·','ðŸ’³','ðŸ’Ž','âš–ï¸','ðŸªœ','ðŸ§°','ðŸª›','ðŸ”§','ðŸ”¨','âš’ï¸','ðŸ› ï¸','ðŸ”©','âš™ï¸','ðŸª¤','ðŸ”—','â›“ï¸','ðŸ§²','ðŸ”«','ðŸ’£','ðŸ§¨','ðŸª“','ðŸ”ª','ðŸ—¡ï¸','ðŸ›¡ï¸','ðŸš¬','âš°ï¸','ðŸª¦','âš±ï¸','ðŸº','ðŸ”®','ðŸ“¿','ðŸ§¿','ðŸ’ˆ','âš—ï¸','ðŸ”­','ðŸ”¬','ðŸ•³ï¸','ðŸ©¹','ðŸ©º','ðŸ’Š','ðŸ’‰','ðŸ©¸','ðŸ§¬','ðŸ¦ ','ðŸ§«','ðŸ§ª'],
  },
  {
    name: 'Symbols',
    emojis: ['âœ…','âŒ','â“','â—','â€¼ï¸','â‰ï¸','ðŸ’¯','ðŸ”¥','âœ¨','â­','ðŸŒŸ','ðŸ’«','ðŸ’¥','ðŸ’¢','ðŸ’¨','ðŸ’¦','ðŸ•Šï¸','ðŸŽµ','ðŸŽ¶','ðŸ”‡','ðŸ”ˆ','ðŸ”‰','ðŸ”Š','ðŸ“Œ','ðŸ“','ðŸ','ðŸš©','ðŸ³ï¸','ðŸ´','ðŸ³ï¸â€ðŸŒˆ','ðŸ³ï¸â€âš§ï¸','â™»ï¸','âœ”ï¸','â˜‘ï¸','âž•','âž–','âž—','âœ–ï¸','â™¾ï¸','ðŸ’²','ðŸ’±','Â©ï¸','Â®ï¸','â„¢ï¸'],
  },
]

const activeCategory = ref(0)
const searchQuery = ref('')

const filteredCategories = computed(() => {
  if (!searchQuery.value) return categories
  const q = searchQuery.value.toLowerCase()
  return categories
    .map((cat) => ({
      ...cat,
      emojis: cat.emojis.filter((e) => e.includes(q)),
    }))
    .filter((cat) => cat.emojis.length > 0)
})

const displayCategories = computed(() => {
  if (searchQuery.value) return filteredCategories.value
  const cat = categories[activeCategory.value]
  return cat ? [cat] : []
})

function selectEmoji(emoji: string) {
  emit('select', emoji)
}
</script>

<template>
  <div class="w-[320px] rounded-lg border border-border bg-popover shadow-lg">
    <!-- Category tabs -->
    <div class="flex gap-1 border-b border-border/50 px-2 py-1.5">
      <button
        v-for="(cat, i) in categories"
        :key="cat.name"
        @click="activeCategory = i"
        :class="[
          'rounded px-1.5 py-0.5 text-lg transition-colors',
          activeCategory === i ? 'bg-accent' : 'hover:bg-accent/50',
        ]"
        :title="cat.name"
      >
        {{ cat.emojis[0] }}
      </button>
    </div>

    <!-- Emoji grid -->
    <ScrollArea class="h-[240px]">
      <div class="p-2">
        <template v-if="displayCategories.length > 0">
          <div
            v-for="cat in displayCategories"
            :key="cat.name"
          >
            <div v-if="searchQuery" class="mb-1 text-xs font-semibold text-muted-foreground">
              {{ cat.name }}
            </div>
            <div class="grid grid-cols-8 gap-0.5">
              <button
                v-for="emoji in cat.emojis"
                :key="emoji"
                @click="selectEmoji(emoji)"
                class="flex h-8 w-8 items-center justify-center rounded text-xl transition-colors hover:bg-accent"
              >
                {{ emoji }}
              </button>
            </div>
          </div>
        </template>
        <div v-else class="py-8 text-center text-sm text-muted-foreground">
          No emojis found
        </div>
      </div>
    </ScrollArea>
  </div>
</template>
